dplyr::summarise(n_per_group = sum(ifelse(preOperative_infection_status!=
"Error: Test result after surgery. Check study_definition.",1,0)),
n_infection_none = sum(ifelse(preOperative_infection_status==
"No record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_0to2wk = sum(ifelse(preOperative_infection_status==
"0-2 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_3to4wk = sum(ifelse(preOperative_infection_status==
"3-4 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_5to6wk = sum(ifelse(preOperative_infection_status==
"5-6 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_7wk = sum(ifelse(preOperative_infection_status==
">=7 weeks record of pre-operative SARS-CoV-2 infection",1,0))
)
tableVacc_postOp_mortality_30day
#######################################################################
# Ensure tibbles show zero values when categories are not in the data #
#######################################################################
# ----
tableVacc_postOp_mortality_30day <-
expand.grid(
surgery_pre_or_post_COVID_UK =
c("No surgery", "preCOVID surgery", "postCOVID surgery"),
category_vaccination_status_before_test =
c("Confirmed fully vaccinated before test",
"Confirmed partially vaccinated before test",
"At least partially vaccinated before test",
"Confirmed not vaccinated before test",
"Unknown vaccination status before test"),
postOp_mortality_30day =
c("Alive within 30-day post-operation",
"Dead within 30-day post-operation",
"Error: Surgery after death",
"No death recorded",
"No surgery recorded",
"Missing")) %>%
dplyr::full_join(tableVacc_postOp_mortality_30day) %>%
dplyr::arrange(surgery_pre_or_post_COVID_UK) %>%
tidyr::replace_na(list("n_per_group" = 0,
"n_infection_none" = 0,
"n_infection_0to2wk" = 0,
"n_infection_3to4wk" = 0,
"n_infection_5to6wk" = 0,
"n_infection_7wk" = 0))
rm(tableVacc_postOp_mortality_30day)
View(tableVacc_postOp_mortality_30dat)
View(table1_ageGroup)
rm(table1_ageGroup)
View(table1_postOp_mortality_30day)
# ## table1_postOp_mortality_30day.
table1_postOp_mortality_30day <-
expand.grid(
surgery_pre_or_post_COVID_UK =
c("No surgery", "preCOVID surgery", "postCOVID surgery"),
postOp_mortality_30day =
c("Alive within 30-day post-operation",
"Dead within 30-day post-operation",
"Error: Surgery after death",
"No death recorded",
"No surgery recorded",
"Missing")) %>%
dplyr::full_join(table1_postOp_mortality_30day) %>%
dplyr::arrange(surgery_pre_or_post_COVID_UK) %>%
tidyr::replace_na(list("n_per_group" = 0,
"n_infection_none" = 0,
"n_infection_0to2wk" = 0,
"n_infection_3to4wk" = 0,
"n_infection_5to6wk" = 0,
"n_infection_7wk" = 0))
View(tableVacc_postOp_mortality_30dat)
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Missing"))
n_preMarch2020_postOp_mortality_30day
tableVacc_postOp_mortality_30day
#######################################################################
# Ensure tibbles show zero values when categories are not in the data #
#######################################################################
# ----
tableVacc_postOp_mortality_30day <-
expand.grid(
surgery_pre_or_post_COVID_UK =
c("No surgery", "preCOVID surgery", "postCOVID surgery"),
category_vaccination_status_before_test =
c("Confirmed fully vaccinated before test",
"Confirmed partially vaccinated before test",
"At least partially vaccinated before test",
"Confirmed not vaccinated before test",
"Unknown vaccination status before test"),
postOp_mortality_30day =
c("Alive within 30-day post-operation",
"Dead within 30-day post-operation",
"Error: Surgery after death",
"No death recorded",
"No surgery recorded",
"Missing")) %>%
dplyr::full_join(tableVacc_postOp_mortality_30day) %>%
dplyr::arrange(surgery_pre_or_post_COVID_UK) %>%
tidyr::replace_na(list("n_per_group" = 0,
"n_infection_none" = 0,
"n_infection_0to2wk" = 0,
"n_infection_3to4wk" = 0,
"n_infection_5to6wk" = 0,
"n_infection_7wk" = 0))
rm(tableVacc_postOp_mortality_30dat)
#######################################################################
# Ensure tibbles show zero values when categories are not in the data #
#######################################################################
# ----
tableVacc_postOp_mortality_30day <-
expand.grid(
surgery_pre_or_post_COVID_UK =
c("No surgery", "preCOVID surgery", "postCOVID surgery"),
category_vaccination_status_before_test =
c("Confirmed fully vaccinated before test",
"Confirmed partially vaccinated before test",
"At least partially vaccinated before test",
"Confirmed not vaccinated before test",
"Unknown vaccination status before test"),
postOp_mortality_30day =
c("Alive within 30-day post-operation",
"Dead within 30-day post-operation",
"Error: Surgery after death",
"No death recorded",
"No surgery recorded",
"Missing")) %>%
dplyr::full_join(tableVacc_postOp_mortality_30day) %>%
dplyr::arrange(surgery_pre_or_post_COVID_UK) %>%
tidyr::replace_na(list("n_per_group" = 0,
"n_infection_none" = 0,
"n_infection_0to2wk" = 0,
"n_infection_3to4wk" = 0,
"n_infection_5to6wk" = 0,
"n_infection_7wk" = 0))
# ## - surgery era:
# ##    1. "preCOVID sugery"
# ##    2. "postCOVID surgery" (although labelled "post", this means during, too)
# ##    3. "No surgery"
# ## - and whether or not the patient died within 30 days of their surgery:
# ##    1. "Alive within 30-day post-operation"
# ##    2. "Dead within 30-day post-operation"
# ##    3. "Error: Surgery after death"
# ##    4. "No surgery recorded"
# ##    5. "No death recorded"
tableVacc_postOp_mortality_30day <-
myData_noConstraints_vacc %>% dplyr::group_by(surgery_pre_or_post_COVID_UK,
category_vaccination_status_before_test,
postOp_mortality_30day) %>%
dplyr::summarise(n_per_group = sum(ifelse(preOperative_infection_status!=
"Error: Test result after surgery. Check study_definition.",1,0)),
n_infection_none = sum(ifelse(preOperative_infection_status==
"No record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_0to2wk = sum(ifelse(preOperative_infection_status==
"0-2 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_3to4wk = sum(ifelse(preOperative_infection_status==
"3-4 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_5to6wk = sum(ifelse(preOperative_infection_status==
"5-6 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_7wk = sum(ifelse(preOperative_infection_status==
">=7 weeks record of pre-operative SARS-CoV-2 infection",1,0))
)
#######################################################################
# Ensure tibbles show zero values when categories are not in the data #
#######################################################################
# ----
tableVacc_postOp_mortality_30day <-
expand.grid(
surgery_pre_or_post_COVID_UK =
c("No surgery", "preCOVID surgery", "postCOVID surgery"),
category_vaccination_status_before_test =
c("Confirmed fully vaccinated before test",
"Confirmed partially vaccinated before test",
"At least partially vaccinated before test",
"Confirmed not vaccinated before test",
"Unknown vaccination status before test"),
postOp_mortality_30day =
c("Alive within 30-day post-operation",
"Dead within 30-day post-operation",
"Error: Surgery after death",
"No death recorded",
"No surgery recorded",
"Missing")) %>%
dplyr::full_join(tableVacc_postOp_mortality_30day) %>%
dplyr::arrange(surgery_pre_or_post_COVID_UK) %>%
tidyr::replace_na(list("n_per_group" = 0,
"n_infection_none" = 0,
"n_infection_0to2wk" = 0,
"n_infection_3to4wk" = 0,
"n_infection_5to6wk" = 0,
"n_infection_7wk" = 0))
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Missing"))
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day)
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day)
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup()
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup() %>%
dplyr::select(n_per_group)
###########################################
# Make vectors to inform the kable table. #
###########################################
# ----
# Pre-March 2020 totals.
# ## 30-day post-operative mortality.
n_preMarch2020_postOp_mortality_30day <-
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup() %>%
dplyr::select(n_per_group)
n_preMarch2020_postOp_mortality_30day /
tableVacc_postOp_mortality_30day
table1_postOp_mortality_30day
n_preMarch2020_postOp_mortality_30day /
table1_postOp_mortality_30day
n_preMarch2020_postOp_mortality_30day /
table1_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery") %>%
select(n_per_group) %>% sum()
n_preMarch2020_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery")
n_preMarch2020_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery") %>%
select(n_per_group) %>% sum()
43/81
43/(81+69)
43/(81+71)
43/(81+72)
prop_preMarch2020_postOp_mortality_30day <-
n_preMarch2020_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery") %>%
select(n_per_group) %>% sum()
prop_preMarch2020_postOp_mortality_30day
prop_preMarch2020_postOp_mortality_30day <-
n_preMarch2020_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery") %>%
select(n_per_group) %>% sum() %>% colnames("prop_per_group")
?colnames()
###########################################
# Make vectors to inform the kable table. #
###########################################
# ----
# Pre-March 2020 totals.
# ## 30-day post-operative mortality.
n_preMarch2020_Vacc_postOp_mortality_30day <-
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup() %>%
dplyr::select(n_per_group)
prop_preMarch2020_Vacc_postOp_mortality_30day <-
n_preMarch2020_Vacc_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery") %>%
select(n_per_group) %>% sum()
# Post-March 2020 totals.
# ## 30-day post-operative mortality.
n_postMarch2020_Vacc_postOp_mortality_30day <-
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup() %>%
dplyr::select(n_per_group)
prop_postMarch2020_Vacc_postOp_mortality_30day <-
n_preMarch2020_Vacc_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery") %>%
select(n_per_group) %>% sum()
n_postMarch2020_Vacc_postOp_mortality_30day
# No pre-operative infection.
# ## 30-day post-operative mortality.
n_subtotals_infection_none_Vacc_postOp_mortality_30day <-
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup() %>%
dplyr::select(n_infection_none)
n_subtotals_infection_none_Vacc_postOp_mortality_30day
#################################################
# Make tibbles that will inform the final table #
#################################################
# ----
myData_noConstraints_vacc <- myData
# ## Count  of patients in each of the categories for
# ## pre-operative infection status:
# ##    1. "No record of pre-operative SARS-CoV-2 infection"
# ##    2. "0-2 weeks record of pre-operative SARS-CoV-2 infection"
# ##    3. "3-4 weeks record of pre-operative SARS-CoV-2 infection"
# ##    4. ">=7 weeks record of pre-operative SARS-CoV-2 infection"
# ##    5. "Error: Test result after surgery. Check study_definition."
# ##
# ## The counts are also stratified by surgery era:
# ##    1. "preCOVID sugery"
# ##    2. "postCOVID surgery" (although labelled "post", this means during, too)
# ##    3. "No surgery"
# ## Count of patients in each of the categories for pre-operative infection
# ## status:
# ##    1. "No record of pre-operative SARS-CoV-2 infection"
# ##    2. "0-2 weeks record of pre-operative SARS-CoV-2 infection"
# ##    3. "3-4 weeks record of pre-operative SARS-CoV-2 infection"
# ##    4. ">=7 weeks record of pre-operative SARS-CoV-2 infection"
# ##    5. "Error: Test result after surgery. Check study_definition."
# ## ...stratified by...
# ## - surgery era:
# ##    1. "preCOVID sugery"
# ##    2. "postCOVID surgery" (although labelled "post", this means during, too)
# ##    3. "No surgery"
# ## - and whether or not the patient died within 30 days of their surgery:
# ##    1. "Alive within 30-day post-operation"
# ##    2. "Dead within 30-day post-operation"
# ##    3. "Error: Surgery after death"
# ##    4. "No surgery recorded"
# ##    5. "No death recorded"
tableVacc_postOp_mortality_30day <-
myData_noConstraints_vacc %>% dplyr::group_by(surgery_pre_or_post_COVID_UK,
category_vaccination_status_before_test,
postOp_mortality_30day) %>%
dplyr::summarise(n_per_group = sum(ifelse(preOperative_infection_status!=
"Error: Test result after surgery. Check study_definition.",1,0)),
n_infection_none = sum(ifelse(preOperative_infection_status==
"No record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_0to2wk = sum(ifelse(preOperative_infection_status==
"0-2 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_3to4wk = sum(ifelse(preOperative_infection_status==
"3-4 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_5to6wk = sum(ifelse(preOperative_infection_status==
"5-6 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_7wk = sum(ifelse(preOperative_infection_status==
">=7 weeks record of pre-operative SARS-CoV-2 infection",1,0))
)
# ----
#######################################################################
# Ensure tibbles show zero values when categories are not in the data #
#######################################################################
# ----
tableVacc_postOp_mortality_30day <-
expand.grid(
surgery_pre_or_post_COVID_UK =
c("No surgery", "preCOVID surgery", "postCOVID surgery"),
category_vaccination_status_before_test =
c("Confirmed fully vaccinated before test",
"Confirmed partially vaccinated before test",
"At least partially vaccinated before test",
"Confirmed not vaccinated before test",
"Unknown vaccination status before test"),
postOp_mortality_30day =
c("Alive within 30-day post-operation",
"Dead within 30-day post-operation",
"Error: Surgery after death",
"No death recorded",
"No surgery recorded",
"Missing")) %>%
dplyr::full_join(tableVacc_postOp_mortality_30day) %>%
dplyr::arrange(surgery_pre_or_post_COVID_UK) %>%
tidyr::replace_na(list("n_per_group" = 0,
"n_infection_none" = 0,
"n_infection_0to2wk" = 0,
"n_infection_3to4wk" = 0,
"n_infection_5to6wk" = 0,
"n_infection_7wk" = 0))
# ----
#############################################################
# Save tibbles that will inform vectors for the kable table #
#############################################################
# ----
write.csv(
x = tableVacc_postOp_mortality_30day,
file = here::here("output","tableVacc_postOp_mortality_30day.csv")
)
# ----
###########################################
# Make vectors to inform the kable table. #
###########################################
# ----
# Pre-March 2020 totals.
# ## 30-day post-operative mortality.
n_preMarch2020_Vacc_postOp_mortality_30day <-
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup() %>%
dplyr::select(n_per_group)
prop_preMarch2020_Vacc_postOp_mortality_30day <-
n_preMarch2020_Vacc_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="preCOVID surgery") %>%
select(n_per_group) %>% sum()
# Post-March 2020 totals.
# ## 30-day post-operative mortality.
n_postMarch2020_Vacc_postOp_mortality_30day <-
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup() %>%
dplyr::select(n_per_group)
prop_postMarch2020_Vacc_postOp_mortality_30day <-
n_preMarch2020_Vacc_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery") %>%
select(n_per_group) %>% sum()
# No pre-operative infection.
# ## 30-day post-operative mortality.
n_subtotals_infection_none_Vacc_postOp_mortality_30day <-
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup() %>%
dplyr::select(n_infection_none)
n_subtotals_infection_none_Vacc_postOp_mortality_30day <-
n_subtotals_infection_none_Vacc_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery") %>%
select(n_infection_none) %>% sum()
# Pre-operative infection (0-2 weeks).
# ## 30-day post-operative mortality.
n_subtotals_infection_0to2wk_Vacc_postOp_mortality_30day <-
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup() %>%
dplyr::select(n_infection_0to2wk)
n_subtotals_infection_0to2wk_Vacc_postOp_mortality_30day <-
n_subtotals_infection_0to2wk_Vacc_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery") %>%
select(n_infection_0to2wk) %>% sum()
# Pre-operative infection (3-4 weeks).
# ## 30-day post-operative mortality.
n_subtotals_infection_3to4wk_Vacc_postOp_mortality_30day <-
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup() %>%
dplyr::select(n_infection_3to4wk)
n_subtotals_infection_3to4wk_Vacc_postOp_mortality_30day <-
n_subtotals_infection_3to4wk_Vacc_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery") %>%
select(n_infection_3to4wk) %>% sum()
# Pre-operative infection (5-6 weeks).
# ## 30-day post-operative mortality.
n_subtotals_infection_5to6wk_Vacc_postOp_mortality_30day <-
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup() %>%
dplyr::select(n_infection_5to6wk)
n_subtotals_infection_5to6wk_Vacc_postOp_mortality_30day <-
n_subtotals_infection_5to6wk_Vacc_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery") %>%
select(n_infection_5to6wk) %>% sum()
# Pre-operative infection (>=7 weeks).
# ## 30-day post-operative mortality.
n_subtotals_infection_7wk_Vacc_postOp_mortality_30day <-
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery",
(postOp_mortality_30day=="Dead within 30-day post-operation"|
postOp_mortality_30day=="Alive within 30-day post-operation" |
postOp_mortality_30day=="Missing")) %>%
dplyr::arrange(postOp_mortality_30day) %>% dplyr::ungroup() %>%
dplyr::select(n_infection_7wk)
n_subtotals_infection_7wk_Vacc_postOp_mortality_30day <-
n_subtotals_infection_7wk_Vacc_postOp_mortality_30day /
tableVacc_postOp_mortality_30day %>%
dplyr::filter(surgery_pre_or_post_COVID_UK=="postCOVID surgery") %>%
select(n_infection_7wk) %>% sum()
# ----
