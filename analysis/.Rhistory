# Chronic cardiac disease.
list_chronic_cardiac_disease <-
fnc_countsAndPercentages(table_to_use = table1_chronic_cardiac_disease,
strata = "_chronic_cardiac_disease",
strata_col = "chronic_cardiac_disease")
# Diabetes.
list_diabetes <-
fnc_countsAndPercentages(table_to_use = table1_diabetes,
strata = "_diabetes",
strata_col = "diabetes")
# Chronic respiratory disease.
list_chronic_respiratory_disease <-
fnc_countsAndPercentages(table_to_use = table1_chronic_respiratory_disease,
strata = "_chronic_respiratory_disease",
strata_col = "chronic_respiratory_disease")
# Cerebrovascular disease.
list_cerebrovascular_disease <-
fnc_countsAndPercentages(table_to_use = table1_cerebrovascular_disease,
strata = "_cerebrovascular_disease",
strata_col = "cerebrovascular_disease")
# ----
list_timing_of_cancer_diagnosis$PP_timing_of_cancer_diagnosis
# Pre-pandemic tables. ----
# ## Demographics table.
tbl_PP_demogs <-
rbind(
list_ageGroup$PP_ageGroup,
list_Sex$PP_Sex,
list_admission_method$PP_admission_method,
list_chronic_cardiac_disease$PP_chronic_cardiac_disease,
list_diabetes$PP_diabetes,
list_chronic_respiratory_disease$PP_chronic_respiratory_disease,
list_cerebrovascular_disease$PP_cerebrovascular_disease) %>%
dplyr::select(strata, n_all_intervals, pct_all_intervals) %>%
tibble::add_column(., c(
rep("Age group",5),
rep("Sex",2),
rep("Admission method",3),
rep("Chronic cardiac disease",2),
rep("Diabetes",2),
rep("Chronic respiratory disease",2),
rep("Cerebrovascular disease",2)),
.before = "strata"
) %>%
`colnames<-`(c("variable", "strata", "n", "pct"))
# ## Outcomes table.
table1Outcomes_PP <-
rbind(
list_postOp_mortality_30day$PP_postOp_mortality_30day,
list_postOp_mortality_90day$PP_postOp_mortality_90day,
list_postOp_mortality_6mth$PP_postOp_mortality_6mth,
list_postOp_mortality_12mth$PP_postOp_mortality_12mth,
list_postOp_pulmonary_complication_30day$PP_pulmonary_complication_30day %>% arrange(desc(strata)),
list_postOp_cardiac_complication_30day$PP_cardiac_complication_30day %>% arrange(desc(strata)),
list_postOp_cerebrovascular_complication_30day$PP_cerebrovascular_complication_30day %>% arrange(desc(strata))) %>%
dplyr::select(strata, n_all_intervals, pct_all_intervals) %>%
dplyr::filter(!strata %in% c("Error: Surgery after death",
"No death recorded", "No surgery recorded")) %>%
tibble::add_column(., c(
rep("30-day post-operative mortality",2),
rep("90-day post-operative mortality",2),
rep("6-month post-operative mortality",2),
rep("12-month post-operative mortality",2),
rep("30-day post-operative pulmonary complication",2),
rep("30-day post-operative cardiac complication",2),
rep("30-day post-operative cerebrovascular complication",2)),
.before = "strata"
) %>%
`colnames<-`(c("variable", "strata", "n", "pct"))
# ## Save table.
write.csv(
x = table1Outcomes_PP,
file = here::here("output",paste0("table1Outcomes_PP","_",sensitivity_cohort,".csv"))
)
# ----
# Pandemic no vaccine tables. ----
# ## Demographics table.
tbl_PNV_demogs <-
rbind(
list_ageGroup$PNV_ageGroup,
list_Sex$PNV_Sex,
list_admission_method$PNV_admission_method,
list_chronic_cardiac_disease$PNV_chronic_cardiac_disease,
list_diabetes$PNV_diabetes,
list_chronic_respiratory_disease$PNV_chronic_respiratory_disease,
list_cerebrovascular_disease$PNV_cerebrovascular_disease) %>%
tibble::add_column(., c(
rep("Age group",5),
rep("Sex",2),
rep("Admission method",3),
rep("Chronic cardiac disease",2),
rep("Diabetes",2),
rep("Chronic respiratory disease",2),
rep("Cerebrovascular disease",2)),
.before = "strata"
) %>%
`colnames<-`(c("variable", "strata", colnames(.)[3:ncol(.)]))
# ## Outcomes table.
table1Outcomes_PNV <-
rbind(
list_postOp_mortality_30day$PNV_postOp_mortality_30day,
list_postOp_mortality_90day$PNV_postOp_mortality_90day,
list_postOp_mortality_6mth$PNV_postOp_mortality_6mth,
list_postOp_mortality_12mth$PNV_postOp_mortality_12mth,
list_postOp_pulmonary_complication_30day$PNV_pulmonary_complication_30day %>% arrange(desc(strata)),
list_postOp_cardiac_complication_30day$PNV_cardiac_complication_30day %>% arrange(desc(strata)),
list_postOp_cerebrovascular_complication_30day$PNV_cerebrovascular_complication_30day %>% arrange(desc(strata))) %>%
dplyr::filter(!strata %in% c("Error: Surgery after death",
"No death recorded", "No surgery recorded")) %>%
tibble::add_column(., c(
rep("30-day post-operative mortality",2),
rep("90-day post-operative mortality",2),
rep("6-month post-operative mortality",2),
rep("12-month post-operative mortality",2),
rep("30-day post-operative pulmonary complication",2),
rep("30-day post-operative cardiac complication",2),
rep("30-day post-operative cerebrovascular complication",2)),
.before = "strata"
) %>%
`colnames<-`(c("variable", "strata", colnames(.)[3:ncol(.)]))
# Save table.
write.csv(
x = table1Outcomes_PNV,
file = here::here("output",paste0("table1Outcomes_PNV","_",sensitivity_cohort,".csv"))
)
# ----
# COVIDSurg data collection period tables. ----
# ## Demographics table.
tbl_CSP_demogs <-
rbind(
list_ageGroup$CSP_ageGroup,
list_Sex$CSP_Sex,
list_admission_method$CSP_admission_method,
list_chronic_cardiac_disease$CSP_chronic_cardiac_disease,
list_diabetes$CSP_diabetes,
list_chronic_respiratory_disease$CSP_chronic_respiratory_disease,
list_cerebrovascular_disease$CSP_cerebrovascular_disease) %>%
tibble::add_column(., c(
rep("Age group",5),
rep("Sex",2),
rep("Admission method",3),
rep("Chronic cardiac disease",2),
rep("Diabetes",2),
rep("Chronic respiratory disease",2),
rep("Cerebrovascular disease",2)),
.before = "strata"
) %>%
`colnames<-`(c("variable", "strata", colnames(.)[3:ncol(.)]))
# ## Outcomes table.
table1Outcomes_CSP <-
rbind(
list_postOp_mortality_30day$CSP_postOp_mortality_30day,
list_postOp_mortality_90day$CSP_postOp_mortality_90day,
list_postOp_mortality_6mth$CSP_postOp_mortality_6mth,
list_postOp_mortality_12mth$CSP_postOp_mortality_12mth,
list_postOp_pulmonary_complication_30day$CSP_pulmonary_complication_30day %>% arrange(desc(strata)),
list_postOp_cardiac_complication_30day$CSP_cardiac_complication_30day %>% arrange(desc(strata)),
list_postOp_cerebrovascular_complication_30day$CSP_cerebrovascular_complication_30day %>% arrange(desc(strata))) %>%
dplyr::filter(!strata %in% c("Error: Surgery after death",
"No death recorded", "No surgery recorded")) %>%
tibble::add_column(., c(
rep("30-day post-operative mortality",2),
rep("90-day post-operative mortality",2),
rep("6-month post-operative mortality",2),
rep("12-month post-operative mortality",2),
rep("30-day post-operative pulmonary complication",2),
rep("30-day post-operative cardiac complication",2),
rep("30-day post-operative cerebrovascular complication",2)),
.before = "strata"
) %>%
`colnames<-`(c("variable", "strata", colnames(.)[3:ncol(.)]))
# Save table.
write.csv(
x = table1Outcomes_CSP,
file = here::here("output",paste0("table1Outcomes_CSP","_",sensitivity_cohort,".csv"))
)
# ----
# Pandemic with vaccine tables. ----
# ## Demographics table.
tbl_PWV_demogs <-
rbind(
list_ageGroup$PWV_ageGroup,
list_Sex$PWV_Sex,
list_admission_method$PWV_admission_method,
list_chronic_cardiac_disease$PWV_chronic_cardiac_disease,
list_diabetes$PWV_diabetes,
list_chronic_respiratory_disease$PWV_chronic_respiratory_disease,
list_cerebrovascular_disease$PWV_cerebrovascular_disease) %>%
tibble::add_column(., c(
rep("Age group",5),
rep("Sex",2),
rep("Admission method",3),
rep("Chronic cardiac disease",2),
rep("Diabetes",2),
rep("Chronic respiratory disease",2),
rep("Cerebrovascular disease",2)),
.before = "strata"
) %>%
`colnames<-`(c("variable", "strata", colnames(.)[3:ncol(.)]))
# ## Outcomes table.
table1Outcomes_PWV <-
rbind(
list_postOp_mortality_30day$PWV_postOp_mortality_30day,
list_postOp_mortality_90day$PWV_postOp_mortality_90day,
list_postOp_mortality_6mth$PWV_postOp_mortality_6mth,
list_postOp_mortality_12mth$PWV_postOp_mortality_12mth,
list_postOp_pulmonary_complication_30day$PWV_pulmonary_complication_30day %>% arrange(desc(strata)),
list_postOp_cardiac_complication_30day$PWV_cardiac_complication_30day %>% arrange(desc(strata)),
list_postOp_cerebrovascular_complication_30day$PWV_cerebrovascular_complication_30day %>% arrange(desc(strata))) %>%
dplyr::filter(!strata %in% c("Error: Surgery after death",
"No death recorded", "No surgery recorded")) %>%
tibble::add_column(., c(
rep("30-day post-operative mortality",2),
rep("90-day post-operative mortality",2),
rep("6-month post-operative mortality",2),
rep("12-month post-operative mortality",2),
rep("30-day post-operative pulmonary complication",2),
rep("30-day post-operative cardiac complication",2),
rep("30-day post-operative cerebrovascular complication",2)),
.before = "strata"
) %>%
`colnames<-`(c("variable", "strata", colnames(.)[3:ncol(.)]))
# Save table.
write.csv(
x = table1Outcomes_PWV,
file = here::here("output",paste0("table1Outcomes_PWV","_",sensitivity_cohort,".csv"))
)
# ----
###########################################################################
# Remove the <Age group> variable from demographic table, for publication #
###########################################################################
# ----
# Pre-pandemic.
table1Demogs_PP <-
tbl_PP_demogs %>% dplyr::filter(variable != "Age group")
table1Demogs_PP[,3:ncol(table1Demogs_PP)] <-
table1Demogs_PP %>% dplyr::select(-c(variable, strata)) %>%
sapply(as.double)
# Pandemic no vaccine.
table1Demogs_PNV <-
tbl_PNV_demogs %>% dplyr::filter(variable != "Age group")
table1Demogs_PNV[,3:ncol(table1Demogs_PNV)] <-
table1Demogs_PNV %>% dplyr::select(-c(variable, strata)) %>%
sapply(as.double)
# COVIDSurg data collection period.
table1Demogs_CSP <-
tbl_CSP_demogs %>% dplyr::filter(variable != "Age group")
table1Demogs_CSP[,3:ncol(table1Demogs_CSP)] <-
table1Demogs_CSP %>% dplyr::select(-c(variable, strata)) %>%
sapply(as.double)
# Pandemic with vaccine.
table1Demogs_PWV <-
tbl_PWV_demogs %>% dplyr::filter(variable != "Age group")
table1Demogs_PWV[,3:ncol(table1Demogs_PWV)] <-
table1Demogs_PWV %>% dplyr::select(-c(variable, strata)) %>%
sapply(as.double)
# ----
# Make a tibble for 'Timing of cancer diagnosis', for the demographic table. #
##############################################################################
# ----
# ## Count of patients in each of the categories for pre-operative infection
# ## status (stratified by surgery era; see above) also stratified by whether
# ## they a cancer diagnosis is received within plus/minus 3 months of their
# ## surgery:
# ##    1. Within 3 months
# ##    2. Outwith 3 months
# ##    3. No cancer diagnosis
table1_timing_of_cancer_diagnosis <-
data_to_use %>%
dplyr::filter(postOp_mortality_30day %in% c("Dead within 30 days post-operation",
"Alive within 30 days post-operation",
"No death recorded")) %>%
dplyr::mutate(
timing_of_cancer_diagnosis = dplyr::case_when(
.$category_cancer_within_3mths_surgery %in%
c("Cancer diagnosis within 3mths after surgery",
"Cancer diagnosis within 3mths before surgery") ~ "Within 3 months",
.$category_cancer_within_3mths_surgery ==
"No cancer diagnosis within 3mths before or after surgery" ~ "Outwith 3 months",
.$has_cancer == FALSE ~ "No cancer diagnosis",
)
) %>%
dplyr::group_by(era, timing_of_cancer_diagnosis) %>%
dplyr::summarise(n_all_intervals = sum(ifelse(preOperative_infection_status!=
"Error: Test result after surgery. Check study_definition.",1,0)),
n_infection_none = sum(ifelse(preOperative_infection_status==
"No record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_0to2wk = sum(ifelse(preOperative_infection_status==
"0-2 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_3to4wk = sum(ifelse(preOperative_infection_status==
"3-4 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_5to6wk = sum(ifelse(preOperative_infection_status==
"5-6 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_7wk = sum(ifelse(preOperative_infection_status==
">=7 weeks record of pre-operative SARS-CoV-2 infection",1,0))
) %>%
dplyr::mutate(across(.cols = intervals_infection, .fns = ~ replace(., (. <= 7 & .  > 0), NA))) %>%
dplyr::mutate(across(.cols = intervals_infection, .fns = ~ . %>% `/`(5) %>% round()*5))
table1_CSP_timing_of_cancer_diagnosis <-
data_to_use %>%
dplyr::filter(postOp_mortality_30day %in% c("Dead within 30 days post-operation",
"Alive within 30 days post-operation",
"No death recorded")) %>%
dplyr::mutate(
timing_of_cancer_diagnosis = dplyr::case_when(
.$category_cancer_within_3mths_surgery %in%
c("Cancer diagnosis within 3mths after surgery",
"Cancer diagnosis within 3mths before surgery") ~ "Within 3 months",
.$category_cancer_within_3mths_surgery ==
"No cancer diagnosis within 3mths before or after surgery" ~ "Outwith 3 months",
.$has_cancer == FALSE ~ "No cancer diagnosis",
)
) %>%
dplyr::group_by(COVIDSurg_data_collection_period, timing_of_cancer_diagnosis) %>%
dplyr::summarise(n_all_intervals = sum(ifelse(preOperative_infection_status!=
"Error: Test result after surgery. Check study_definition.",1,0)),
n_infection_none = sum(ifelse(preOperative_infection_status==
"No record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_0to2wk = sum(ifelse(preOperative_infection_status==
"0-2 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_3to4wk = sum(ifelse(preOperative_infection_status==
"3-4 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_5to6wk = sum(ifelse(preOperative_infection_status==
"5-6 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_7wk = sum(ifelse(preOperative_infection_status==
">=7 weeks record of pre-operative SARS-CoV-2 infection",1,0))
) %>%
dplyr::mutate(across(.cols = intervals_infection, .fns = ~ replace(., (. <= 7 & .  > 0), NA))) %>%
dplyr::mutate(across(.cols = intervals_infection, .fns = ~ . %>% `/`(5) %>% round()*5)) %>%
dplyr::rename(era = COVIDSurg_data_collection_period)
table1_timing_of_cancer_diagnosis <-
dplyr::bind_rows(table1_CSP_timing_of_cancer_diagnosis,
table1_timing_of_cancer_diagnosis)
rm(table1_CSP_timing_of_cancer_diagnosis)
# ## Ensure tibble shows zero values when categories are not in the data.
table1_timing_of_cancer_diagnosis <-
expand.grid(
era =
era_set,
timing_of_cancer_diagnosis =
c("Within 3 months",
"Outwith 3 months",
"No cancer diagnosis")) %>%
dplyr::full_join(table1_timing_of_cancer_diagnosis %>% tidyr::replace_na(na_replace_list_temp)) %>%
dplyr::arrange(era) %>%
replace(is.na(.), 0) %>%
replace(. == na_replace_list_temp[[1]], NA)
table_to_use = table1_timing_of_cancer_diagnosis
strata = "_timing_of_cancer_diagnosis"
strata_col = "timing_of_cancer_diagnosis"
# Define reusable items.
era_longname <- c("Pre-pandemic", "Pandemic no vaccine",
"COVIDSurg data collection period", "Pandemic with vaccine")
#era_shortname <- paste0(c("PP", "PNV", "CSP", "PWV"), strata)
era_shortname <- c("PP", "PNV", "CSP", "PWV")
# Make tables
table_to_use <- table_to_use %>% dplyr::rename(strata = strata_col)
table_to_use
table1_timing_of_cancer_diagnosis <-
data_to_use %>%
dplyr::filter(postOp_mortality_30day %in% c("Dead within 30 days post-operation",
"Alive within 30 days post-operation",
"No death recorded")) %>%
dplyr::mutate(
timing_of_cancer_diagnosis = dplyr::case_when(
.$category_cancer_within_3mths_surgery %in%
c("Cancer diagnosis within 3mths after surgery",
"Cancer diagnosis within 3mths before surgery") ~ "Within 3 months",
.$category_cancer_within_3mths_surgery ==
"No cancer diagnosis within 3mths before or after surgery" ~ "Outwith 3 months",
.$has_cancer == FALSE ~ "No cancer diagnosis",
)
) %>%
dplyr::group_by(era, timing_of_cancer_diagnosis) %>%
dplyr::summarise(n_all_intervals = sum(ifelse(preOperative_infection_status!=
"Error: Test result after surgery. Check study_definition.",1,0)),
n_infection_none = sum(ifelse(preOperative_infection_status==
"No record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_0to2wk = sum(ifelse(preOperative_infection_status==
"0-2 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_3to4wk = sum(ifelse(preOperative_infection_status==
"3-4 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_5to6wk = sum(ifelse(preOperative_infection_status==
"5-6 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_7wk = sum(ifelse(preOperative_infection_status==
">=7 weeks record of pre-operative SARS-CoV-2 infection",1,0))
)
?tidyr
?dplyr
table1_timing_of_cancer_diagnosis <-
data_to_use %>%
dplyr::filter(postOp_mortality_30day %in% c("Dead within 30 days post-operation",
"Alive within 30 days post-operation",
"No death recorded")) %>%
dplyr::mutate(
timing_of_cancer_diagnosis = dplyr::case_when(
.$category_cancer_within_3mths_surgery %in%
c("Cancer diagnosis within 3mths after surgery",
"Cancer diagnosis within 3mths before surgery") ~ "Within 3 months",
.$category_cancer_within_3mths_surgery ==
"No cancer diagnosis within 3mths before or after surgery" ~ "Outwith 3 months",
.$has_cancer == FALSE ~ "No cancer diagnosis",
)
) %>%
dplyr::group_by(era, timing_of_cancer_diagnosis) %>%
dplyr::summarise(n_all_intervals = sum(ifelse(preOperative_infection_status!=
"Error: Test result after surgery. Check study_definition.",1,0)),
n_infection_none = sum(ifelse(preOperative_infection_status==
"No record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_0to2wk = sum(ifelse(preOperative_infection_status==
"0-2 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_3to4wk = sum(ifelse(preOperative_infection_status==
"3-4 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_5to6wk = sum(ifelse(preOperative_infection_status==
"5-6 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_7wk = sum(ifelse(preOperative_infection_status==
">=7 weeks record of pre-operative SARS-CoV-2 infection",1,0))
)
table1_CSP_timing_of_cancer_diagnosis <-
data_to_use %>%
dplyr::filter(postOp_mortality_30day %in% c("Dead within 30 days post-operation",
"Alive within 30 days post-operation",
"No death recorded")) %>%
dplyr::mutate(
timing_of_cancer_diagnosis = dplyr::case_when(
.$category_cancer_within_3mths_surgery %in%
c("Cancer diagnosis within 3mths after surgery",
"Cancer diagnosis within 3mths before surgery") ~ "Within 3 months",
.$category_cancer_within_3mths_surgery ==
"No cancer diagnosis within 3mths before or after surgery" ~ "Outwith 3 months",
.$has_cancer == FALSE ~ "No cancer diagnosis",
)
) %>%
dplyr::group_by(COVIDSurg_data_collection_period, timing_of_cancer_diagnosis) %>%
dplyr::summarise(n_all_intervals = sum(ifelse(preOperative_infection_status!=
"Error: Test result after surgery. Check study_definition.",1,0)),
n_infection_none = sum(ifelse(preOperative_infection_status==
"No record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_0to2wk = sum(ifelse(preOperative_infection_status==
"0-2 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_3to4wk = sum(ifelse(preOperative_infection_status==
"3-4 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_5to6wk = sum(ifelse(preOperative_infection_status==
"5-6 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_7wk = sum(ifelse(preOperative_infection_status==
">=7 weeks record of pre-operative SARS-CoV-2 infection",1,0))
)
table1_CSP_timing_of_cancer_diagnosis <-
data_to_use %>%
dplyr::filter(postOp_mortality_30day %in% c("Dead within 30 days post-operation",
"Alive within 30 days post-operation",
"No death recorded")) %>%
dplyr::mutate(
timing_of_cancer_diagnosis = dplyr::case_when(
.$category_cancer_within_3mths_surgery %in%
c("Cancer diagnosis within 3mths after surgery",
"Cancer diagnosis within 3mths before surgery") ~ "Within 3 months",
.$category_cancer_within_3mths_surgery ==
"No cancer diagnosis within 3mths before or after surgery" ~ "Outwith 3 months",
.$has_cancer == FALSE ~ "No cancer diagnosis",
)
) %>%
dplyr::group_by(COVIDSurg_data_collection_period, timing_of_cancer_diagnosis) %>%
dplyr::summarise(n_all_intervals = sum(ifelse(preOperative_infection_status!=
"Error: Test result after surgery. Check study_definition.",1,0)),
n_infection_none = sum(ifelse(preOperative_infection_status==
"No record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_0to2wk = sum(ifelse(preOperative_infection_status==
"0-2 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_3to4wk = sum(ifelse(preOperative_infection_status==
"3-4 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_5to6wk = sum(ifelse(preOperative_infection_status==
"5-6 weeks record of pre-operative SARS-CoV-2 infection",1,0)),
n_infection_7wk = sum(ifelse(preOperative_infection_status==
">=7 weeks record of pre-operative SARS-CoV-2 infection",1,0))
) %>%
#dplyr::mutate(across(.cols = intervals_infection, .fns = ~ replace(., (. <= 7 & .  > 0), NA))) %>%
#dplyr::mutate(across(.cols = intervals_infection, .fns = ~ . %>% `/`(5) %>% round()*5)) %>%
dplyr::rename(era = COVIDSurg_data_collection_period)
table1_timing_of_cancer_diagnosis <-
dplyr::bind_rows(table1_CSP_timing_of_cancer_diagnosis,
table1_timing_of_cancer_diagnosis)
rm(table1_CSP_timing_of_cancer_diagnosis)
expand.grid(
era =
era_set,
timing_of_cancer_diagnosis =
c("Within 3 months",
"Outwith 3 months",
"No cancer diagnosis")) %>%
dplyr::full_join(table1_timing_of_cancer_diagnosis)
expand.grid(
era =
era_set,
timing_of_cancer_diagnosis =
c("Within 3 months",
"Outwith 3 months",
"No cancer diagnosis")) %>%
dplyr::full_join(table1_timing_of_cancer_diagnosis %>% tidyr::replace_na(na_replace_list_temp)) %>%
dplyr::arrange(era) %>%
replace(is.na(.), 0) %>%
replace(. == na_replace_list_temp[[1]], NA)
data_to_use %>%
dplyr::filter(postOp_mortality_30day %in% c("Dead within 30 days post-operation",
"Alive within 30 days post-operation",
"No death recorded")) %>% select(category_cancer_within_3mths_surgery) %>% table()
data_to_use %>%
dplyr::filter(postOp_mortality_30day %in% c("Dead within 30 days post-operation",
"Alive within 30 days post-operation",
"No death recorded")) %>% select(category_cancer_within_3mths_surgery, era) %>% table()
18350-(8157-1012)
18350-(8157+1012)
